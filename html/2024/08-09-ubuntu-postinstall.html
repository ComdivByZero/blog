<!DOCTYPE html>

<html lang="ru">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Ubuntu 24.04</title>

  <link rel="stylesheet" type="text/css" href="../main.css"/>
</head>

<body>
<h2>Что надо сделать после установки Ubuntu 24.04</h2>
  
<strike>Удалить Ubuntu</strike>
<!--more-->
<p>Увеличим безопасность и удобство.</p>

<p>Подробней:</p>
<ul>
  <li><a href='../../2024/01/blog-post.html'>Уведомление о свободном месте</a>
  <li><a href='../../2024/01/limited-exec.html'>Ограничиваемый запуск программ в GNU/Linux</a>
  <li><a href='../../2016/01/big-mistake-in-using-sudo.html'>Вы используете sudo неправильно или фундаментальная проблема $PATH</a>
  <li><a href='../../2023/03/urk-keyboard.html'>Дополнительные символы в украинской раскладке и расширенная русская</a>
</ul>

<style>a.self::before { content: attr(href); } p.fs {display: none;} pre {background-color:#F8F8F8; overflow:auto;}
  strike {display:none;}</style>


<br/>
<label>ubuntu-post-install.sh:</label>
<pre><code>#!/bin/sh

# Установи trash для удаления в корзину из ком-строки, библиотеку просмотра avif,
# micro для редактирования в терминале привычным для графического режима способом
/bin/sudo apt install trash-cli libavif-gdk-pixbuf micro --yes

# <b>Закрой от редактирования настройки shell</b>
/bin/sudo sh -c 'chown root ~/.bashrc ~/.profile
chmod 640 ~/.bashrc ~/.profile'

# <b>Настрой в Gnome адекватные величины для уведомлений о нехватке свободного места</b>
note() { gsettings set org.gnome.settings-daemon.plugins.housekeeping free-$1 $2; }
note percent-notify       0.25
note percent-notify-again 0.10
note size-gb-no-notify    101

# <b>Установи clean-gnu для освобождения от мусора</b>
pushd /tmp
git clone https://github.com/ComdivByZero/clean-gnu.git --depth 1 &&
/bin/sudo install clean-gnu/*.sh /usr/local/bin/
popd

# <b>Установи lime для запуска команд в ограничениях</b>
pushd /tmp
git clone https://github.com/ComdivByZero/lime.git --depth 1 && cd lime &&
/bin/sudo sh -c 'apt install cgroup-tools debootstrap trash-cli --yes
P=/usr/local; R=/etc/sudoers.d/lime
cp lime $P/bin/
cp lime_backend.sh $P/lib/
echo "%sudo ALL=(root) NOPASSWD: $P/lib/lime_backend.sh" >> $R
chmod 0440 $R
visudo --check'
popd
</code></pre>


<p># Дополнительно</p>
<pre><code># <b>Установи оболочку fish вместо bash</b>
FC=~/.config/fish/config.fish
[ -f $FC ] || install -Dm 640 /dev/null $FC

/bin/sudo sh -c"apt install fish
chown root $FC
chsh -s /usr/bin/fish $USER"
</code></pre>

<pre><code># <b>Замени раскладку ua(homophonic) на unicode версию для</b>
# <b>удобного ввода русского и некоторых дополнительных литер</b>
FP="/usr/share/X11/xkb/symbols/ua"
TF=$(mktemp)

cat &lt;&lt;EOF >"$TF"
xkb_symbols "homophonic" {

    include "ua(unicode)"

    name[Group1]= "Ukrainian (ru)";

    key &lt;AE01>  {[               1,          exclam,    onesuperior,             notsign ]};
    key &lt;AE03>  {[               3,      numerosign,        section,          numbersign ]};
    key &lt;AE05>  {[               5,         percent,         degree,               U20B4 ]};
    key &lt;AE06>  {[               6,           colon,           less,               U2264 ]};
    key &lt;AE07>  {[               7,        question,        greater,               U2265 ]};
    key &lt;AE08>  {[               8,        asterisk, enfilledcircbullet,     asciicircum ]};

    key &lt;AD07>  {[    Cyrillic_ghe,     Cyrillic_GHE,      ampersand                  ]};
    key &lt;AD12>  {[Cyrillic_hardsign,Cyrillic_HARDSIGN,   Ukrainian_yi,   Ukrainian_YI ]};

    key &lt;AC01>  {[     Cyrillic_ef,     Cyrillic_EF,          U0040                   ]};
    key &lt;AC02>  {[   Cyrillic_yeru,   Cyrillic_YERU,    Ukrainian_i,      Ukrainian_I ]};
    key &lt;AC10>  {[    Cyrillic_zhe,    Cyrillic_ZHE,          U0461,           U0460  ]}; // Ѡ
    key &lt;AC11>  {[      Cyrillic_e,      Cyrillic_E,    Ukrainian_ie,     Ukrainian_IE ]};
    key &lt;AC12>  {[    Ukrainian_ge,    Ukrainian_GE,    Ukrainian_ie,     Ukrainian_IE ]};
    
    key &lt;BKSL>  {[backslash, bar, Ukrainian_ghe_with_upturn, Ukrainian_GHE_WITH_UPTURN ]};

    include "level3(ralt_switch)"
};
EOF

/bin/sudo cp "$FP" "${FP}~"
/bin/sudo sed -i "/xkb_symbols \"homophonic\" {/,/^}/{
    /^}/r $TF
    d
}" "$FP"

rm "$TF"
</code></pre>

</body>
</html>
