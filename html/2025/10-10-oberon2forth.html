<!DOCTYPE html>

<html lang="ru">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>O→F</title>

  <link rel="stylesheet" type="text/css" href="../main.css"/>
</head>

<body>
<h2>Превращение O→F</h2>
<p>Убого:<p/>
<pre><code>MODULE Power;

 PROCEDURE Do*(x: REAL; n: INTEGER): REAL;
 VAR y: REAL; i: INTEGER;
 BEGIN
  ASSERT(n >= 0);

  y := 1.0; i := n;
  WHILE i > 0 DO
    IF ODD(i) THEN y := y*x END;
    x := x*x; i := i DIV 2
  END
 RETURN
  y
 END Do;

END Power.
</code></pre>

<details><summary>Уже лучше:</summary>
<pre><code>: power ( real x  integer n -- real )
  real y  integer i

  n 0 &lt; assert
  1.0 =:y
  n =:i
  begin
    i 0 >
  while
    i odd if y x * =:y then
    x x * =:x
    i 2 div =:i
  end
  y
;</code></pre>
  
  <details><summary>Божественно:</summary>
<pre><code>: power ( n -- ) ( F: x -- y )
  dup 0&lt; if drop fdrop abort then
  >r 1e
  begin r@ 0> while
    r@ 1 and 0&lt;> if fover f* then
    fswap fdup f* fswap
    r> 2/ >r
  repeat
  r> drop fnip
;
</code></pre></details>
    
</details>

</body>
</html>
