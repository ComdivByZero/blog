<!DOCTYPE html>

<html lang="ru">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>O→P</title>

  <link rel="stylesheet" type="text/css" href="../main.css"/>
</head>

<body><h2>Превращение O→P</h2>
<p>Убого:</p>
<pre><code>MODULE Power;

 PROCEDURE Do*(x: REAL; n: INTEGER): REAL;
 VAR y: REAL; i: INTEGER;
 BEGIN
  ASSERT(n >= 0);

  y := 1.0; i := n;
  WHILE i > 0 DO
    IF ODD(i) THEN y := y*x END;
    x := x*x; i := i DIV 2
  END
 RETURN
  y
 END Do;

END Power.</code></pre>

<details><summary>Уже лучше:</summary>
<pre><code>sub power($x real, $n int) {
    assert $n &lt; 0;
    
    var $y = 1.0;
    while ($n > 0) {
        $y *= $x if $n % 2;
        $x *= $x;
        $n = int($n / 2);
    }
    return $y;
}</code></pre>


<details><summary>Божественно:</summary>
<pre><code>use feature 'current_sub';
sub power{$_[1]?($_[1]%2?$_[0]:1)*__SUB__->($_[0]*$_[0],int $_[1]/2):1}</code></pre></details>
</details>
</body>
</html>
